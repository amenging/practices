<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>^-^</title>
  </head>
 
  <body onload="main()">
    <canvas id="webgl" width="400" height="400">
    Please use a browser that supports "canvas"
    </canvas>

    <script src="./lib/webgl-utils.js"></script>
    <script src="./lib/webgl-debug.js"></script>
    <script src="./lib/cuon-utils.js"></script>
    <script src="./lib/cuon-matrix.js"></script>
    <script>
      function main () {
        let vShader = `
          attribute vec4 a_Position;
          attribute float a_PointSize;

          void main () {
            gl_Position = a_Position;
            gl_PointSize = a_PointSize;
          }
        `

        let fShader = `
          precision mediump float;
          uniform vec4 u_FragColor;

          void main () {
            gl_FragColor = u_FragColor;
          }
        `

        const canvas = document.getElementById('webgl')

        const gl = getWebGLContext(canvas, true)

        gl.clear(gl.COLOR_BUFFER_BIT)
        gl.clearColor(0, 0, 0, .5)

        initShaders(gl, vShader, fShader) // 此处创建gl.program

        let a_Position = gl.getAttribLocation(gl.program, 'a_Position')
        let a_PointSize = gl.getAttribLocation(gl.program, 'a_PointSize')
        let u_FragColor = gl.getUniformLocation(gl.program, 'u_FragColor')

        let vertices = new Float32Array([
          0.0, 0.5,
          -0.5, -0.5,
          0.5, -0.5
        ])

        let sizes = new Float32Array([
          10.0, 20.0, 30.0
        ])

        let vertexBuffer = gl.createBuffer()
        let sizeBuffer = gl.createBuffer()

        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer)
        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW)
        gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 0, 0)
        gl.enableVertexAttribArray(a_Position)

        gl.bindBuffer(gl.ARRAY_BUFFER, sizeBuffer)
        gl.bufferData(gl.ARRAY_BUFFER, sizes, gl.STATIC_DRAW)
        gl.vertexAttribPointer(a_PointSize, 1, gl.FLOAT, false, 0, 0)
        gl.enableVertexAttribArray(a_PointSize)

        gl.drawArrays(gl.POINTS, 0, 3)
      }
    </script>
  </body>
</html>
